import ssl
import socket
import pyfiglet
from datetime import datetime

def print_title():
    title = pyfiglet.figlet_format("Pentest Probe")
    print(title)

def get_ssl_certificate(hostname):
    context = ssl.create_default_context()
    conn = context.wrap_socket(socket.socket(socket.AF_INET), server_hostname=hostname)
    conn.settimeout(5.0)
    conn.connect((hostname, 443))
    cert = conn.getpeercert()
    conn.close()
    return cert

def get_ssl_version(hostname):
    context = ssl.create_default_context()
    conn = context.wrap_socket(socket.socket(socket.AF_INET), server_hostname=hostname)
    conn.settimeout(5.0)
    conn.connect((hostname, 443))
    ssl_version = conn.version()
    conn.close()
    return ssl_version

def categorize_ssl_version(version):
    if version == 'TLSv1.3':
        return 'Excellent'
    elif version == 'TLSv1.2':
        return 'Good'
    elif version in ['TLSv1.1', 'TLSv1']:
        return 'Poor'
    else:
        return 'Unknown'

def main(domain):
    print(f"Starting SSL scan for {domain}\n")
    
    cert = get_ssl_certificate(domain)
    ssl_version = get_ssl_version(domain)
    version_category = categorize_ssl_version(ssl_version)

    # Explaining the certificate details
    print(f"SSL/TLS Certificate Details for {domain}:\n")
    print(f"1. Subject (The entity the certificate is issued to):")
    for item in cert.get('subject', []):
        print(f"   - {item[0][0]}: {item[0][1]}")

    print(f"\n2. Issuer (The entity that issued the certificate):")
    for item in cert.get('issuer', []):
        print(f"   - {item[0][0]}: {item[0][1]}")

    print(f"\n3. Version: {cert.get('version', 'N/A')}")

    print(f"\n4. Serial Number: {cert.get('serialNumber', 'N/A')}")

    print(f"\n5. Validity Period:")
    print(f"   - Not Before: {cert.get('notBefore', 'N/A')}")
    print(f"   - Not After: {cert.get('notAfter', 'N/A')}")

    print(f"\n6. Subject Alternative Name (Other entities the certificate is valid for):")
    for item in cert.get('subjectAltName', []):
        print(f"   - {item[0]}: {item[1]}")

    print(f"\n7. OCSP (Online Certificate Status Protocol): {cert.get('OCSP', 'N/A')}")
    
    print(f"\n8. CA Issuers (Certificate Authority Issuers): {cert.get('caIssuers', 'N/A')}")

    print(f"\n9. CRL Distribution Points (Certificate Revocation List): {cert.get('crlDistributionPoints', 'N/A')}")

    print(f"\nSSL/TLS Version: {ssl_version} ({version_category})\n")

if __name__ == "__main__":
    print_title()
    domain = input("Enter the domain to scan: ")
    main(domain)
